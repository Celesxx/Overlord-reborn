//==================================================================================
//Copier coller les lignes de sheet dans var str = ``;
var str = `monstre des marécages	monstre-m	2	12	70	5	0	marécages	60	30	38	10	15	10	0	0	1	1	-1	vous crache un jet d'acide.	grince des dents avant de gonfler sa gorge et vous balance une remontée gastrique du fond de son estomac. 	25	15	10	10	Envoi un liquide vert et visqueux depuis une de ses cavitées abdominales. Une verue ? Un abscès ? Qu'importe, dans le dégout vous tentez de l'esquiver mais vous vous le prenez de plein fouet.		15	0	1	1	1	-1	Se racle la gorge et dans la foulée vous jette au visage les reste de son dernier repas.	9999	9999	0	0	70	5	1	-1	20 bronze	35 bronze			20	40	un petit monstre empestant les marécages 	https://www.journalduparanormal.com/wp-content/uploads/2015/10/la-creature-des-marais.jpg	https://www.journalduparanormal.com/wp-content/uploads/2015/10/la-creature-des-marais.jpg	https://www.journalduparanormal.com/wp-content/uploads/2015/10/la-creature-des-marais.jpg	https://www.journalduparanormal.com/wp-content/uploads/2015/10/la-creature-des-marais.jpg	https://www.journalduparanormal.com/wp-content/uploads/2015/10/la-creature-des-marais.jpg
tigre des marécages	tigre-m	1	14	120	5	5	marécages	20	35	40	20	15	10	0	0	2	1	-1	sort ses griffes acérées se rue rapidement sur vous.	utilise ses dents acérées pour les planter dans votre chair.	-25	10	10	15	se déchaîne. Il bondit d'arbres en rochers et vous rue de coups de griffes et de crocs. Ses coups sont moins puissants dans sa folie mais ils sont plus nombreux. 		35	50	1	1	1	-1	se déchaîne. Il bondit d'arbres en rochers et vous rue de coups de griffes et de crocs. Ses coups sont critique et puissants et ils sont plus nombreux. 	9999	9999	0	0	70	5	1	-1	35 bronze	50 bronze			25	45	Un tigre géant qui semble extrement rapide et agile !	http://st.gde-fon.com/wallpapers_original/437655_art_boloto_monstr_voda_les_chashha_tuman_1680x1050_www.Gde-Fon.com.jpg	https://cdn.discordapp.com/attachments/562281586549194752/971045315195068496/unknown.png	https://cdn.discordapp.com/attachments/562281586549194752/971045315195068496/unknown.png	https://media.discordapp.net/attachments/562281586549194752/971045535559602186/unknown.png?width=520&height=677	http://st.gde-fon.com/wallpapers_original/437655_art_boloto_monstr_voda_les_chashha_tuman_1680x1050_www.Gde-Fon.com.jpg
petit arbros	arbros	1	15	200	7	0	marécages	15	45	65	10	12	35	0	0	2	1	-1	lance son immense bras sur vous, deblayant tout sur son passage. 	prend une posture différente. Vous êtes comme hypnotisé par la lueur qui s'intensifie en son coeur, tandis qu'il se laisse tomber de tous son poids sur vous.	60	5	5	20	arrête d'attaquer. Son coeur devient d'un rouge intense et flamboie de mille feux. Il se met à exploser.		10	0	1	1	1	-1	arrête d'attaquer. Son coeur devient d'un rouge intense et flamboie de mille feux. Il se met à exploser de façon critique.	15	30	10	10	20	5	1	-1	50 bronze	60 bronze			30	50	Un pas si petit arbre centenaire bien vivant qui est prêt à vous écraser	https://images-ext-1.discordapp.net/external/GBbI20P6Aj0WEuZgCRJt1R77oEwZ6-DuRufOON35koE/https/besthqwallpapers.com/Uploads/26-9-2017/21718/thumb2-monster-fantasy-art-forest-darkness.jpg	https://images-ext-1.discordapp.net/external/GBbI20P6Aj0WEuZgCRJt1R77oEwZ6-DuRufOON35koE/https/besthqwallpapers.com/Uploads/26-9-2017/21718/thumb2-monster-fantasy-art-forest-darkness.jpg	https://images-ext-1.discordapp.net/external/GBbI20P6Aj0WEuZgCRJt1R77oEwZ6-DuRufOON35koE/https/besthqwallpapers.com/Uploads/26-9-2017/21718/thumb2-monster-fantasy-art-forest-darkness.jpg	https://images-ext-1.discordapp.net/external/GBbI20P6Aj0WEuZgCRJt1R77oEwZ6-DuRufOON35koE/https/besthqwallpapers.com/Uploads/26-9-2017/21718/thumb2-monster-fantasy-art-forest-darkness.jpg	https://images-ext-1.discordapp.net/external/GBbI20P6Aj0WEuZgCRJt1R77oEwZ6-DuRufOON35koE/https/besthqwallpapers.com/Uploads/26-9-2017/21718/thumb2-monster-fantasy-art-forest-darkness.jpg
tortue colossale des marécages	tortue-m	1	15	300	10	15	marécages	4	25	35	5	20	15	0	0	2	1	-1	se retourne et tente de vous désiquillibrer avec sa queue.	se déchaîne et allonge violement son coup jusqu'à vous attraper avec sa solide machoîre.	15	10	0	0	La tortue bondit et se recroqueville dans sa carapace. Elle se laisse tomber de tout son poid et crée une onde de choc qui affecte la première ligne.		0	0	1	1	1	-1	La tortue bondit et se recroqueville dans sa carapace. Elle se laisse tomber de tout son poid et crée une onde de choc critique qui affecte la première ligne.	10	20	5	9999	20	5	1	-1	55 bronze	70 bronze			35	55	Une géante tortue qui semble pour le moins indestructible 	https://media.discordapp.net/attachments/939189314993139752/939630879498698772/318dfa188093eef801ef750b09885d13.png?width=477&height=675	https://cdn.discordapp.com/attachments/562281586549194752/971042654227943444/unknown.png	https://cdn.discordapp.com/attachments/562281586549194752/971042654227943444/unknown.png	https://cdn.discordapp.com/attachments/562281586549194752/971042654227943444/unknown.png	https://media.discordapp.net/attachments/939189314993139752/939630879498698772/318dfa188093eef801ef750b09885d13.png?width=477&height=675
Le roi des marécages		1	65	5000	-	50	marécages	1	80	130	10	30	30	20	0	0	0	0	Le roi vous charge et vous inflige de lourd dégats !	Le roi vous charge et vous inflige un énorme coup de tête qui inflige des dégats critique !	-100	5	20	20	Le roi lache un crie extrement lourd qui inflige des dégats à tout le monde et paralyse tout le monde pendant 2 tours !		0	0	1	0	0	0	Le roi lache un crie extrement lourd qui paralyse tout le monde pendant 2 tours !	60	100	10	9999	25	0	0	0	2000 bronze, 200 argent, 25 or	3000 bronze, 300 argent, 35 or			400	450	Au bout d'un moment vous ressentez comme de léger tremblement venant du sol, puis au fur et à mesure que le temps passe, les tremblements sont de plus en plus fort et vous entendez dans le même temps de lourd bruit de pas qui déchire les arbres à son passage. Avant même que vous ailliez le temps de réaliser ce qu'il ce passe, c'était trop tard... Le roi des marécages gardien de ce sanctuaire n'était plus qu'à quelques mètre de vous, c'est à vous demander comment il est à pu arriver aussi vite... La seul solution, COURIR !	https://media.discordapp.net/attachments/951928506021998652/971879685116014592/3def3ee019360c77eda5f8c74c3705d6.jpg	https://media.discordapp.net/attachments/951928506021998652/971879685434769408/tales-of-legendia-anime.gif	https://media.discordapp.net/attachments/951928506021998652/971880148234289272/a04ba37064c96262acb6c553d1315c2c.gif	https://media.discordapp.net/attachments/951928506021998652/971880147563204669/7TZe.gif	https://media.discordapp.net/attachments/951928506021998652/971879685116014592/3def3ee019360c77eda5f8c74c3705d6.jpg`;
//==================================================================================




//==================================================================================
//retourne l'objet de spawn
function spawn(zone,drop){
    var tabZone = zone.split(",");
    var tabDrop = drop.split(",");
    var tabObj = [];
    for(var k =0;k<tabZone.length;k++){
        tabObj.push(`{"zone":"${tabZone[k]}","drop":${tabDrop[k]}}`);
    }
    return tabObj.join(",");
}
//==================================================================================
//Retourne le nombre de gold en se basant sur une case du sheet
function gold(val,type){
    if(val.includes(type)){ 
        var tabVal = val.split(",");
        for(e of tabVal){
            if(e.includes(type)){
                var tabE = e.split(" ");
                return tabE[0];
            }
        }
    }
    return 0; 
}
//==================================================================================
//Prend un résultats et le formate pour match avec l'écriture array en JSON
function makeArray(str){
    if(str != ""){ 
        var strTab = str.split(',');
        if(strTab.length == 1){
            return '"'+str+'"'; // Return si qu'un élément
        }
        return strTab.join('","'); //Return si plusieurs éléments
    }
    return str; //Return si vide
}
//==================================================================================
//Un monstre
function unObjet(str){
    var tabStr = str.split("\t");
    if(tabStr.length != 54){ //Car sinon ça peut tout décaler  'n'
        return "";
    }
    var json = `
    "${tabStr[1]}": {
        "nom": "${tabStr[0]}", 
        "nomId": "${tabStr[1]}",
        "image": "${tabStr[49]}",
        "imageAttaque": "${tabStr[50]}",
        "imageCritique": "${tabStr[51]}",
        "imageSkill": "${tabStr[52]}",
        "imageMiss": "${tabStr[53]}",
        "description": "${tabStr[48]}",
        "lvl": ${tabStr[3]},
        "hp": [${tabStr[4]}, ${tabStr[5]}],
        "armure": ${tabStr[6]},
        "spawn": [${spawn(tabStr[7],tabStr[8])}],
        "position": ${tabStr[2]},
        "attaque": 
        {
            "description": "${tabStr[19]}",
            "descriptionCrit": "${tabStr[20]}",
            "degat": [${tabStr[9]}, ${tabStr[10]}],
            "crit": [${tabStr[11]}, ${tabStr[12]}],
            "miss": ${tabStr[13]},
            "penetration": ${tabStr[14]},
            "poison": ${tabStr[15]},
            "level": [${tabStr[16]},${tabStr[17]},${tabStr[18]}]
        },
        "attaqueSpecial": 
        [{
            "activation": ${tabStr[22]},
            "description": "${tabStr[33]}",
            "repeat": [${tabStr[28]}, ${tabStr[29]}],
            "degatBonus": ${tabStr[21]},
            "crit":
            {
                "description": "${tabStr[25]}",
                "activation": ${tabStr[23]},
                "degatBonus": ${tabStr[24]}
            },
            "miss": ${tabStr[27]},
            "level": [${tabStr[30]},${tabStr[31]},${tabStr[32]}]
        }],
        "blocage": 
        {
            "degat": [${tabStr[34]},${tabStr[35]}],
            "crit": [${tabStr[36]}, ${tabStr[37]}],
            "miss": ${tabStr[38]},
            "level": [${tabStr[39]},${tabStr[40]},${tabStr[41]}]
        },
        "loot": 
        {
            "gold":
            {
                "bronze": [${gold(tabStr[42],"bronze")},${gold(tabStr[43],"bronze")}],
                "argent": [${gold(tabStr[42],"argent")},${gold(tabStr[43],"argent")}],
                "or": [${gold(tabStr[42],"or")},${gold(tabStr[43],"or")}]
            },
            "item": 
            { 
                "chance": [${tabStr[44]}], 
                "loot": [${makeArray(tabStr[45])}]
            },
            "xp": [${tabStr[46]},${tabStr[47]}]
        }
    }`;
    return json;
}
//==================================================================================

base = "{";
var rows = str.split("\n");
for(row of rows){
    var obj = unObjet(row)
    if(obj == ""){
        continue;
    }
    base+= obj+",";
}
base+="\n}";
console.log(base); 
//Possibilité de mettre le res dans un txt avec
// node zelgius.js > res.txt