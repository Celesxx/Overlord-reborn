//==================================================================================
//Copier coller les lignes de sheet dans var str = ``;
var str = `loup	loup-s	1	4	60	2	0	plaine, forêt	80, 40	20	25	10	15	30	0	0	2	1	-1	assène un coup de griffe infligeant	assène un énorme coup de griffe critique infligeant	25	5	10	10	assène un puissant coup de morsure critique infligeant	-	10	0	1	2	2	-1	assène un puissant coup de morsure infligeant	9999	9999	0	0	70	0	0	-1	20 bronze	30 bronze	-	-	20	30	Un petit loup sauvage assoiffé de sang et de chair fraiche !	https://cdn.discordapp.com/attachments/723538729012297834/724774265269911622/fantasyart-1592870026825-1545.jpg	https://cdn.discordapp.com/attachments/723538729012297834/724774265269911622/fantasyart-1592870026825-1545.jpg	https://cdn.discordapp.com/attachments/951928506021998652/967135105481080882/wolfattack.gif	https://media.discordapp.net/attachments/951928506021998652/967135169603579914/wolfs-rain-wolf.gif	https://cdn.discordapp.com/attachments/951928506021998652/967135221973672056/ckc.gif
mercenaire combattant	mercenaire-c	1	7	95	5	10	plaine, forêt	10, 20	15	30	10	20	20	0	0	5	1	-1	fonce sur vous et vous assène un coup d'épée infligeant	vous surprend assènant un coup critique touchant un point vital infligeant	10	15	25	0	vous assène un violent coup au visage, du pommeau de son arme ce qui vous sonne (pas d'action lors de votre tour "?passe [idCombat]" ) et vous inflige	-	20	0	1	1	2	-1	tente de vous assomer avec un coup au visage mais c'est un échec, cependant il arrive à vous infliger	10	20	10	10	10	5	1	-1	30 bronze	70 bronze	5	potionhp-s	30	40	un combattant mercenaire qui n'est pas la pour rigoler, seulement pour votre bourse !	https://media.discordapp.net/attachments/951928506021998652/956742243983687760/1051e4c4ef161b2bf06e8d6b2190a4dd.jpg?width=433&height=670	https://cdn.discordapp.com/attachments/951928506021998652/967137360196296724/tenor.gif	https://cdn.discordapp.com/attachments/951928506021998652/967136897753309294/158902.gif	https://cdn.discordapp.com/attachments/951928506021998652/967135497665282098/y5a02e.gif	https://cdn.discordapp.com/attachments/951928506021998652/956361545175150662/ac8bc3366058336faf13e2414cbdb579.png
mercenaire archer	mercenaire-a	2	7	75	5	5	plaine, forêt	9, 10	25	30	15	20	20	0	0	5	1	-1	vous tire une flèche depuis sa position et vous inflige	vous tire une flèche causant un critique en touchant un point vital infligeant	-10	10	10	10	tire une volée de flèche qui n'épargne personne (tous le monde ce prend les dégats) infligeant	-	20	0	1	1	2	-1	tire une volée de flèche touchant 1 autre personne au passage (priorité à la 2éme ligne si y'en à pas alors la 1ère) infligeant	7	14	10	10	15	5	1	-1	30 bronze	80 bronze	5	potionhp-s	25	40	un archer mercenaire qui n'est pas la pour rigoler, seulement pour votre bourse !	https://media.discordapp.net/attachments/951928506021998652/956742243983687760/1051e4c4ef161b2bf06e8d6b2190a4dd.jpg?width=436&height=676	https://cdn.discordapp.com/attachments/951928506021998652/967139203148304384/tumblr_nns4kkl31k1rvm3kjo2_540.gif	https://cdn.discordapp.com/attachments/951928506021998652/967139247192686622/e94656e72a190d47c4c14d74782f265b.gif	https://cdn.discordapp.com/attachments/951928506021998652/967139246257365063/fa557f5fba1748cddf68b38e334c96fb.gif	https://cdn.discordapp.com/attachments/951928506021998652/956361545175150662/ac8bc3366058336faf13e2414cbdb579.png
Kirishiga la dernière ombre	kirishiga	l	50	2500	-	25	plaine	1	50	120	20	30	20	0	0	0	0	0	vous crie dessus avant de vous asséner un énorme coup de queue inflgeant	s'envole avant de vous foncer dessus et vous chopper au passage avant de vous balancer d'une grande violence contre un arbre infligeant	-80	20	10	15	invoque un puissant coup d'éclair venant du ciel touchant toutes la deuxième ligne ce qui la paralysera pendant 2 tour (fuite toujours possible cependant) et infligeant	-	20	0	1	1	2	-1	invoque un puissant coup d'éclair venant vous paralyser pendant 2 tours (fuite toujours possible cependant) et infligeant	50	70	10	20	5	0	0	0	1000 bronze, 100 argent, 10 or	1500 bronze, 150 argent, 15 or	-	-	300	350	vous remarqué au bout d'un moment	https://media.discordapp.net/attachments/966093187661832282/966151888397565982/caroline-gariba-stormwingentity.jpg?width=960&height=670	-	-	-	-
																					-50	35	15	10	vous choppe par ses griffe accérés avant de vous balancer et de prendre son envole d'une vitesse fulgurante, se cachant dans les nuages avant de foncer en piqué attaquant au hasard une personne de la seconde ligne infligeant	-	20	10	2	0	0	0	vous balance un coup de queue puissant avant de prendre son envole d'une vitesse fulgurante, se cachant dans les nuages avant de foncer en piqué attaquant au hasard une personne de la seconde ligne infligeant																				
monstre des marécages	monstre-m	2	15	115	5	5	marécages	60	45	60	10	15	10	0	0	1	1	-1	vous crache un jet d'acide.	grince des dents avant de gonfler sa gorge et vous balance une remontée gastrique du fond de son estomac.	25	15	10	10	Envoi un liquide vert et visqueux depuis une de ses cavitées abdominales. Une verue ? Un abscès ? Qu'importe, dans le dégout vous tentez de l'esquiver mais vous vous le prenez de plein fouet.	-	15	0	1	1	1	-1	Se racle la gorge et dans la foulée vous jette au visage les reste de son dernier repas.	9999	9999	0	0	70	5	1	-1	50 bronze, 0 argent	100 bronze, 1 argent	-	-	30	50	un petit monstre empestant les marécages	https://www.journalduparanormal.com/wp-content/uploads/2015/10/la-creature-des-marais.jpg	https://www.journalduparanormal.com/wp-content/uploads/2015/10/la-creature-des-marais.jpg	https://www.journalduparanormal.com/wp-content/uploads/2015/10/la-creature-des-marais.jpg	https://www.journalduparanormal.com/wp-content/uploads/2015/10/la-creature-des-marais.jpg	https://www.journalduparanormal.com/wp-content/uploads/2015/10/la-creature-des-marais.jpg
tigre des marécages	tigre-m	1	18	120	5	5	marécages	20	45	60	20	15	10	0	0	2	1	-1	sort ses griffes acérées se rue rapidement sur vous.	utilise ses dents acérées pour les planter dans votre chair.	-25	10	10	15	se déchaîne. Il bondit d'arbres en rochers et vous rue de coups de griffes et de crocs. Ses coups sont moins puissants dans sa folie mais ils sont plus nombreux.	-	35	50	1	1	1	-1	se déchaîne. Il bondit d'arbres en rochers et vous rue de coups de griffes et de crocs. Ses coups sont critique et puissants et ils sont plus nombreux.	9999	9999	0	0	70	5	1	-1	60 bronze, 0 argent	120 bronze, 1 argent	-	-	35	60	Un tigre géant qui semble extrement rapide et agile !	http://st.gde-fon.com/wallpapers_original/437655_art_boloto_monstr_voda_les_chashha_tuman_1680x1050_www.Gde-Fon.com.jpg	https://cdn.discordapp.com/attachments/562281586549194752/971045315195068496/unknown.png	https://cdn.discordapp.com/attachments/562281586549194752/971045315195068496/unknown.png	https://media.discordapp.net/attachments/562281586549194752/971045535559602186/unknown.png?width=520&height=677	http://st.gde-fon.com/wallpapers_original/437655_art_boloto_monstr_voda_les_chashha_tuman_1680x1050_www.Gde-Fon.com.jpg
petit arbros	arbros	1	21	200	7	20	marécages	15	35	55	10	12	35	0	0	2	1	-1	lance son immense bras sur vous, deblayant tout sur son passage.	prend une posture différente. Vous êtes comme hypnotisé par la lueur qui s'intensifie en son coeur, tandis qu'il se laisse tomber de tous son poids sur vous.	60	5	5	20	arrête d'attaquer. Son coeur devient d'un rouge intense et flamboie de mille feux. Il se met à exploser.	-	10	0	1	1	1	-1	arrête d'attaquer. Son coeur devient d'un rouge intense et flamboie de mille feux. Il se met à exploser de façon critique.	25	35	10	10	20	5	1	-1	100 bronze, 1 argent	200 bronze, 2 argent	-	-	40	70	Un pas si petit arbre centenaire bien vivant qui est prêt à vous écraser	https://images-ext-1.discordapp.net/external/GBbI20P6Aj0WEuZgCRJt1R77oEwZ6-DuRufOON35koE/https/besthqwallpapers.com/Uploads/26-9-2017/21718/thumb2-monster-fantasy-art-forest-darkness.jpg	https://images-ext-1.discordapp.net/external/GBbI20P6Aj0WEuZgCRJt1R77oEwZ6-DuRufOON35koE/https/besthqwallpapers.com/Uploads/26-9-2017/21718/thumb2-monster-fantasy-art-forest-darkness.jpg	https://images-ext-1.discordapp.net/external/GBbI20P6Aj0WEuZgCRJt1R77oEwZ6-DuRufOON35koE/https/besthqwallpapers.com/Uploads/26-9-2017/21718/thumb2-monster-fantasy-art-forest-darkness.jpg	https://images-ext-1.discordapp.net/external/GBbI20P6Aj0WEuZgCRJt1R77oEwZ6-DuRufOON35koE/https/besthqwallpapers.com/Uploads/26-9-2017/21718/thumb2-monster-fantasy-art-forest-darkness.jpg	https://images-ext-1.discordapp.net/external/GBbI20P6Aj0WEuZgCRJt1R77oEwZ6-DuRufOON35koE/https/besthqwallpapers.com/Uploads/26-9-2017/21718/thumb2-monster-fantasy-art-forest-darkness.jpg
tortue colossale des marécages	tortue-m	1	24	325	10	30	marécages	4	30	40	5	20	15	0	0	2	1	-1	se retourne et tente de vous désiquillibrer avec sa queue.	se déchaîne et allonge violement son coup jusqu'à vous attraper avec sa solide machoîre.	15	10	0	0	La tortue bondit et se recroqueville dans sa carapace. Elle se laisse tomber de tout son poid et crée une onde de choc qui affecte la première ligne.	-	0	0	1	1	1	-1	La tortue bondit et se recroqueville dans sa carapace. Elle se laisse tomber de tout son poid et crée une onde de choc critique qui affecte la première ligne.	30	40	5	9999	20	5	1	-1	150 bronze, 1 argent	300 bronze, 3 argent	-	-	50	80	Une géante tortue qui semble pour le moins indestructible	https://media.discordapp.net/attachments/939189314993139752/939630879498698772/318dfa188093eef801ef750b09885d13.png?width=477&height=675	https://cdn.discordapp.com/attachments/562281586549194752/971042654227943444/unknown.png	https://cdn.discordapp.com/attachments/562281586549194752/971042654227943444/unknown.png	https://cdn.discordapp.com/attachments/562281586549194752/971042654227943444/unknown.png	https://media.discordapp.net/attachments/939189314993139752/939630879498698772/318dfa188093eef801ef750b09885d13.png?width=477&height=675
Le roi des marécages		1	65	5000	-	50	marécages	1	80	130	10	30	30	20	0	0	0	0	Le roi vous charge et vous inflige de lourd dégats !	Le roi vous charge et vous inflige un énorme coup de tête qui inflige des dégats critique !	-100	5	20	20	Le roi lache un crie extrement lourd qui inflige des dégats à tout le monde et paralyse tout le monde pendant 2 tours !	-	0	0	1	0	0	0	Le roi lache un crie extrement lourd qui paralyse tout le monde pendant 2 tours !	60	100	10	9999	25	0	0	0	2000 bronze, 200 argent, 25 or	3000 bronze, 300 argent, 35 or	-	-	400	450	Au bout d'un moment vous ressentez comme de léger tremblement venant du sol, puis au fur et à mesure que le temps passe, les tremblements sont de plus en plus fort et vous entendez dans le même temps de lourd bruit de pas qui déchire les arbres à son passage. Avant même que vous ailliez le temps de réaliser ce qu'il ce passe, c'était trop tard... Le roi des marécages gardien de ce sanctuaire n'était plus qu'à quelques mètre de vous, c'est à vous demander comment il est à pu arriver aussi vite... La seul solution, COURIR !	https://media.discordapp.net/attachments/951928506021998652/971879685116014592/3def3ee019360c77eda5f8c74c3705d6.jpg	https://media.discordapp.net/attachments/951928506021998652/971879685434769408/tales-of-legendia-anime.gif	https://media.discordapp.net/attachments/951928506021998652/971880148234289272/a04ba37064c96262acb6c553d1315c2c.gif	https://media.discordapp.net/attachments/951928506021998652/971880147563204669/7TZe.gif	https://media.discordapp.net/attachments/951928506021998652/971879685116014592/3def3ee019360c77eda5f8c74c3705d6.jpg
petit démon sanguinaire	démon-cs	2	15	150	7	20	taverne	60	25	55	15	15	10	20	0	2	1	-1	fonce sur vous et vous assène un violent coup d'épée infligeant	lève son épée bien haut avant de vous assèner un énorme coup d'épée infligeant de lourd dégat	-80	30	15	30	hurle de toute ses forces d'un crie démoniaque d'une grande puissance causant en vous un frisson de terreur, ce qui embrouille votre perception du combat et vous oblige à frapper en priorité le démond pendant ce tour et le prochain	-	10	0	1	1	1	-1	hurle de toute ses forces d'un crie démoniaque causant en vous un frisson de terreur, ce qui embrouille votre perception du combat et vous oblige à frapper en priorité le démond pendant ce tour et le prochain	20	45	10	20	10	5	1	-1	50 bronze	60 bronze	-	-	25	50	Un guerrier démon prêt à vous découper d'une rare violence	https://media.discordapp.net/attachments/951928506021998652/977590180649259018/73d094d94343fdf4720e0ba6e7aeabea.gif	https://media.discordapp.net/attachments/951928506021998652/977589971793879130/8ed862883a12ecaac7175809022035eefa405e97_hq.gif	https://cdn.discordapp.com/attachments/951928506021998652/977589972762755092/giphy.gif	https://cdn.discordapp.com/attachments/951928506021998652/977589972183961630/370r.gif	https://media.discordapp.net/attachments/951928506021998652/977589974465667152/telechargement.gif`



//==================================================================================
//retourne l'objet de spawn
function spawn(zone,drop){
    var tabZone = zone.split(",");
    var tabDrop = drop.split(",");
    var tabObj = [];
    for(var k =0;k<tabZone.length;k++){
        tabObj.push(`{"zone":"${tabZone[k]}","drop":${tabDrop[k]}}`);
    }
    return tabObj.join(",");
}
//==================================================================================
//Retourne le nombre de gold en se basant sur une case du sheet
function gold(val,type){
    if(val.includes(type)){ 
        var tabVal = val.split(",");
        for(e of tabVal){
            if(e.includes(type)){
                var tabE = e.split(" ");
                return tabE[0];
            }
        }
    }
    return 0; 
}
//==================================================================================
//Prend un résultats et le formate pour match avec l'écriture array en JSON
function makeArray(str){
    if(str != ""){ 
        var strTab = str.split(',');
        if(strTab.length == 1){
            return '"'+str+'"'; // Return si qu'un élément
        }
        return strTab.join('","'); //Return si plusieurs éléments
    }
    return str; //Return si vide
}
//==================================================================================
//Un monstre
function unObjet(str){
    var tabStr = str.split("\t");
    if(tabStr.length != 54){ //Car sinon ça peut tout décaler  'n'
        return "";
    }
    var json = `
    "${tabStr[1]}": {
        "nom": "${tabStr[0] != "-" ? tabStr[0] : ""}", 
        "nomId": "${tabStr[1] != "-" ? tabStr[1] : "" }",
        "image": "${tabStr[49] != "-" ? tabStr[49] : "" }",
        "imageAttaque": "${tabStr[50] != "-" ? tabStr[50] : "" }",
        "imageCritique": "${tabStr[51] != "-" ? tabStr[51] : "" }",
        "imageSkill": "${tabStr[52] != "-" ? tabStr[52] : "" }",
        "imageMiss": "${tabStr[53] != "-" ? tabStr[53] : "" }",
        "description": "${tabStr[48] != "-" ? tabStr[48] : "" }",
        "lvl": ${tabStr[3] != "-" ? tabStr[3] : 99 },
        "hp": [${tabStr[4] != "-" ? tabStr[4] : 0 }, ${tabStr[5] != "-" ? tabStr[5] : 0 }],
        "armure": ${tabStr[6] != "-" ? tabStr[6] : 0 },
        "spawn": [${spawn(tabStr[7] != "-" ? tabStr[7] : "" ,tabStr[8] != "-" ? tabStr[8] : 0 )}],
        "position": ${tabStr[2] != "-" ? tabStr[2] : 1 },
        "attaque": 
        {
            "description": "${tabStr[19] != "-" ? tabStr[19] : 0 }",
            "descriptionCrit": "${tabStr[20] != "-" ? tabStr[20] : 0 }",
            "degat": [${tabStr[9] != "-" ? tabStr[9] : 0 }, ${tabStr[10] != "-" ? tabStr[10] : 0 }],
            "crit": [${tabStr[11] != "-" ? tabStr[11] : 0 }, ${tabStr[12] != "-" ? tabStr[12] : 0 }],
            "miss": ${tabStr[13] != "-" ? tabStr[13] : 0 },
            "penetration": ${tabStr[14] != "-" ? tabStr[14] : 0 },
            "poison": ${tabStr[15] != "-" ? tabStr[15] : 0 },
            "level": [${tabStr[16] != "-" ? tabStr[16] : 0 },${tabStr[17] != "-" ? tabStr[17] : 0 },${tabStr[18] != "-" ? tabStr[8] : 0 }]
        },
        "attaqueSpecial": 
        [{
            "activation": ${tabStr[22] != "-" ? tabStr[22] : 0 },
            "description": "${tabStr[33] != "-" ? tabStr[33] : "" }",
            "repeat": [${tabStr[28] != "-" ? tabStr[28] : 0 }, ${tabStr[29] != "-" ? tabStr[29] : 0 }],
            "degatBonus": ${tabStr[21] != "-" ? tabStr[21] : 0 },
            "crit":
            {
                "description": "${tabStr[25] != "-" ? tabStr[25] : 0 }",
                "activation": ${tabStr[23] != "-" ? tabStr[23] : 0 },
                "degatBonus": ${tabStr[24] != "-" ? tabStr[24] : 0 }
            },
            "miss": ${tabStr[27] != "-" ? tabStr[27] : 0 },
            "level": [${tabStr[30] != "-" ? tabStr[30] : 0 },${tabStr[31] != "-" ? tabStr[31] : 0 },${tabStr[32] != "-" ? tabStr[32] : 0 }]
        }],
        "blocage": 
        {
            "degat": [${tabStr[34] != "-" ? tabStr[34] : 0 },${tabStr[35] != "-" ? tabStr[35] : 0 }],
            "crit": [${tabStr[36] != "-" ? tabStr[36] : 0 }, ${tabStr[37] != "-" ? tabStr[37] : 0 }],
            "miss": ${tabStr[38] != "-" ? tabStr[38] : 0 },
            "level": [${tabStr[39] != "-" ? tabStr[39] : 0 },${tabStr[40] != "-" ? tabStr[40] : 0 },${tabStr[41] != "-" ? tabStr[41] : 0 }]
        },
        "loot": 
        {
            "gold":
            {
                "bronze": [${gold(tabStr[42] != "-" ? tabStr[42] : 0 ,"bronze")},${gold(tabStr[43] != "-" ? tabStr[43] : 0 ,"bronze")}],
                "argent": [${gold(tabStr[42] != "-" ? tabStr[42] : 0 ,"argent")},${gold(tabStr[43] != "-" ? tabStr[43] : 0 ,"argent")}],
                "or": [${gold(tabStr[42] != "-" ? tabStr[42] : 0 ,"or")},${gold(tabStr[43] != "-" ? tabStr[43] : 0 ,"or")}]
            },
            "item": 
            { 
                "chance": [${tabStr[44] != "-" ? tabStr[44] : 0 }], 
                "loot": [${makeArray(tabStr[45] != "-" ? tabStr[45] : "" )}]
            },
            "xp": [${tabStr[46] != "-" ? tabStr[46] : 0 },${tabStr[47] != "-" ? tabStr[47] : 0 }]
        }
    }`;
    return json;
}
//==================================================================================

base = "{";
var rows = str.split("\n");
for(row of rows){
    var obj = unObjet(row)
    if(obj == ""){
        continue;
    }
    base+= obj+",";
}
base+="\n}";
console.log(base); 
//Possibilité de mettre le res dans un txt avec
// node zelgius.js > res.txt